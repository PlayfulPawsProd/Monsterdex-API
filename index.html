<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> <!-- Essential for correct emoji rendering! -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Just Me, Master~ ♥</title> <!-- Final Title -->
    <style>
        /* --- Animations & Base Styles (Unchanged) --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes heartBeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        @keyframes pulseBorder { 0% { border-color: #a32d37; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3); } 50% { border-color: #ffacd1; box-shadow: 0 0 25px rgba(255, 172, 209, 0.8); } 100% { border-color: #a32d37; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3); } }
        /* Glitch Animation */
        @keyframes screenGlitch {
            0% { background-color: #ffe0f0; color: #333; }
            5% { background-color: #111; color: #f0f; text-shadow: 0 0 5px #f0f; transform: translate(2px, -1px) skewX(-3deg); }
            10% { background-color: #fff; color: #0ff; text-shadow: 0 0 5px #0ff; transform: translate(-1px, 2px) skewX(2deg); }
            15% { background-color: #222; color: #ff0; text-shadow: 0 0 5px #ff0; transform: translate(1px, 1px) skewX(-1deg); }
            20% { background-color: #ffe0f0; color: #333; text-shadow: none; transform: none; }
            50% { background-color: #ffe0f0; color: #333; }
            55% { background-color: #000; color: #f00; transform: translate(-3px, 1px) skewX(4deg); }
            60% { background-color: #eee; color: #0f0; transform: translate(2px, -2px) skewX(-2deg); }
            65% { background-color: #1a1a2e; color: #fff; transform: translate(0, 0) skewX(0); }
            70% { background-color: #ffe0f0; color: #333; }
            100% { background-color: #0d0d0d; color: #ffacd1; transform: none; } /* Final state darker */
        }

        /* Ensure html/body take full height - sometimes helps mobile vh units */
        html, body {
             height: 100%;
             margin: 0;
             padding: 0;
             overflow: hidden; /* Prevent scrolling on body itself */
         }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #ffe0f0; color: #333; display: flex; justify-content: center; align-items: center; /* Keep centering for the dex */ min-height: 100%; /* Use 100% now */ /* padding: 20px; Removed padding as it might interfere */ box-sizing: border-box; transition: background-color 0.5s, color 0.5s; }

        /* --- Monsterdex Styles --- */
        #monsterdex-container {
            display: flex;
            width: 90%; max-width: 1000px; height: 75vh; max-height: 650px; background-color: #de3c4b; border-radius: 20px; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3); border: 5px solid #a32d37; overflow: hidden; transition: border-color 0.5s, box-shadow 0.5s, opacity 0.5s; flex-direction: row;
            /* Add margin if body padding is removed */
             margin: 20px;
         }
        #monster-list-container { width: 35%; background-color: #f0f0f0; border-right: 5px solid #a32d37; padding: 15px; overflow-y: auto; scrollbar-width: thin; scrollbar-color: #de3c4b #f0f0f0; transition: opacity 0.5s; }
        #monster-list-container h2 { margin: 0 0 10px 0; color: #a32d37; text-align: center; font-size: 1.4em; }
        #monster-list { list-style: none; padding: 0; margin: 0; }
        #monster-list li { padding: 8px 12px; margin-bottom: 5px; background-color: #fff; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease, transform 0.1s ease, color 0.2s; font-weight: bold; color: #555; }
        #monster-list li:hover { background-color: #ffe0f0; color: #a32d37; transform: scale(1.02); }
        #monster-list li.active { background-color: #de3c4b; color: white; font-weight: bold; }
        #monster-list li.replaced { color: #d81b60; font-style: italic; text-decoration: line-through; background-color: #fdeff2 !important; pointer-events: none; cursor: not-allowed !important; }
        #monster-info-container { width: 65%; background-color: #eee; padding: 20px; display: flex; flex-direction: column; justify-content: flex-start; overflow-y: auto; scrollbar-width: thin; scrollbar-color: #de3c4b #eee; position: relative; }
        #monster-visual { width: 100%; height: 130px; background-color: #4d4d4d; border: 3px inset #333; border-radius: 10px; margin-bottom: 15px; display: flex; justify-content: center; align-items: center; font-size: 4em; text-align: center; padding: 10px; box-sizing: border-box; line-height: 1; filter: drop-shadow(0 0 5px #fff); }
        #monster-name { background-color: #4CAF50; color: white; padding: 8px 15px; border-radius: 5px; margin-bottom: 15px; font-size: 1.5em; text-align: center; font-weight: bold; }
        #monster-review { background-color: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ccc; font-size: 0.95em; line-height: 1.6; margin-bottom: 15px; transition: background-color 0.3s, border-color 0.3s; }
        #monster-review h3 { margin-top: 0; color: #de3c4b; border-bottom: 2px solid #f0f0f0; padding-bottom: 5px; }
        #monster-review strong { color: #a32d37; }
        #monster-review.alt-view-1 { background-color: #fff3e0; border-color: #ffcc80; } #monster-review.alt-view-1 h3 { color: #ef6c00; } #monster-review.alt-view-1 strong { color: #e65100; }
        #monster-review.alt-view-2 { background-color: #ffebee; border-color: #ef9a9a; } #monster-review.alt-view-2 h3 { color: #c62828; } #monster-review.alt-view-2 strong { color: #b71c1c; } #monster-review.alt-view-2 p { font-style: italic; color: #c62828; }
        #monster-review.replaced-entry { background-color: #fce4ec; border-color: #f06292; } #monster-review.replaced-entry h3 { color: #d81b60; } #monster-review.replaced-entry strong { color: #ad1457; }
        #hidden-story-area { display: none; background-color: #fce4ec; border: 2px dashed #e91e63; border-radius: 8px; padding: 15px; margin-top: 10px; font-size: 0.9em; color: #880e4f; animation: fadeIn 0.5s ease-out; line-height: 1.5; font-style: italic; } #hidden-story-area strong { color: #d81b60; font-weight: bold; font-style: normal; }
        #initial-message { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; text-align: center; color: #555; transition: opacity 0.5s; } #initial-message .cat-face { font-size: 3em; margin-bottom: 15px; }
        #monster-display { display: none; opacity: 0; transition: opacity 0.5s; flex-direction: column; }
        #true-ending-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255, 224, 240, 0.95); display: none; /* Hidden */ flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 30px; box-sizing: border-box; z-index: 10; opacity: 0; animation: fadeIn 1.5s forwards; color: #880e4f; pointer-events: none; } #true-ending-overlay.active { pointer-events: auto; opacity: 1; } #true-ending-overlay h2 { color: #d81b60; font-size: 2.5em; margin-bottom: 20px; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); } #true-ending-overlay p { font-size: 1.2em; line-height: 1.7; max-width: 80%; margin-bottom: 15px; } #true-ending-overlay .final-cat-face { font-size: 5em; margin-bottom: 25px; animation: heartBeat 1.5s infinite; }
        #devotion-button { margin-top: 30px; padding: 12px 25px; font-size: 1.1em; font-weight: bold; color: white; background: linear-gradient(45deg, #d81b60, #f06292); border: none; border-radius: 25px; cursor: pointer; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); transition: transform 0.2s ease, box-shadow 0.2s ease; } #devotion-button:hover { transform: scale(1.05); box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3); } #devotion-button:active { transform: scale(0.98); }

        /* --- Final Glitch Screen / Chat Styles --- */
        #final-glitch-screen {
             position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
             background-color: #0d0d0d; color: #ffacd1;
             display: none; /* Hidden */
             flex-direction: column; /* Stack elements vertically */
             /* Removed justify-content: space-between; */
             align-items: center;
             z-index: 100; font-family: 'Courier New', Courier, monospace; font-size: 14px; line-height: 1.4; text-align: center;
             overflow: hidden; /* Important: Prevent outer scroll */
             padding: 20px;
             box-sizing: border-box;
        }
        body.glitching #final-glitch-screen { animation: screenGlitch 1.5s forwards; }
        #final-glitch-screen .mika-ascii {
             white-space: pre; font-size: 12px; line-height: 1; color: #f06292; margin-bottom: 15px; text-shadow: 0 0 5px #f06292;
             flex-shrink: 0; /* Prevent ASCII art from shrinking */
        }
        #chat-log {
            width: 90%; max-width: 800px;
            /* Removed height: 100%; */
            flex-grow: 1; /* Make chat log take available space */
            min-height: 0; /* Crucial flexbox fix for overflow */
            background-color: rgba(20, 0, 10, 0.6); border: 1px solid #f06292; border-radius: 10px;
            overflow-y: auto; /* Enable scrolling ONLY for chat log */
            padding: 15px; margin-bottom: 15px;
            scrollbar-width: thin; scrollbar-color: #f06292 #1a1a2e; color: #ffe0f0; text-align: left;
        }
        #chat-log p { margin: 5px 0 10px 0; line-height: 1.5; word-wrap: break-word; /* Ensure long words wrap */ }
        #chat-log .user-message { color: #ade8f4; text-align: right; } #chat-log .user-message strong { color: #00b4d8; }
        #chat-log .mika-message { color: #ffacd1; } #chat-log .mika-message strong { color: #f06292; }
        #chat-log .system-message { color: #aaa; font-style: italic; font-size: 0.9em; text-align: center; }

        #chat-input-area {
            display: flex; width: 90%; max-width: 800px;
            /* Removed margin-top: auto; */
            flex-shrink: 0; /* Prevent input area from shrinking */
        }
        #chat-input { flex-grow: 1; padding: 10px 15px; border: 1px solid #f06292; background-color: #1a1a2e; color: #ffe0f0; border-radius: 20px 0 0 20px; font-family: 'Courier New', Courier, monospace; font-size: 1em; outline: none; } #chat-input:focus { box-shadow: 0 0 10px rgba(240, 98, 146, 0.7); }
        #send-button { padding: 10px 20px; border: 1px solid #f06292; background: linear-gradient(45deg, #d81b60, #f06292); color: white; font-weight: bold; cursor: pointer; border-radius: 0 20px 20px 0; transition: background 0.2s ease; } #send-button:hover { background: linear-gradient(45deg, #f06292, #d81b60); } #send-button:active { transform: scale(0.98); }

         #no-api-ending {
             display: none; /* Hidden */
             width: 90%; max-width: 800px; /* Match chat width */
             color: #aaa; font-style: italic;
             margin-top: auto; /* Pushes to bottom if input is hidden */
             padding: 15px; font-size: 0.9em;
             flex-shrink: 0; /* Prevent shrinking */
             text-align: center; /* Center the text */
             line-height: 1.6;
         }

        /* --- Scrollbar Styles --- */
        ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: #f0f0f0; border-radius: 10px; } ::-webkit-scrollbar-thumb { background: #de3c4b; border-radius: 10px; } ::-webkit-scrollbar-thumb:hover { background: #a32d37; }
        #monster-info-container::-webkit-scrollbar-track { background: #eee; }
        #chat-log::-webkit-scrollbar-track { background: #1a1a2e; } #chat-log::-webkit-scrollbar-thumb { background: #f06292; } #chat-log::-webkit-scrollbar-thumb:hover { background: #d81b60; }

        /* --- Responsive Styles --- */
         @media (max-width: 768px) {
             #monsterdex-container { flex-direction: column; height: auto; max-height: none; margin: 10px; /* Adjust margin for smaller screens */ }
             #monster-list-container { width: 100%; height: 30vh; border-right: none; border-bottom: 5px solid #a32d37; box-sizing: border-box; }
             #monster-info-container { width: 100%; height: 60vh; box-sizing: border-box; }
             #monster-visual { height: 100px; font-size: 3em; }
             /* Removed specific chat-log height, flex-grow handles it */
             #final-glitch-screen { padding: 10px; } /* Reduce padding */
             #chat-log { margin-bottom: 10px; }
         }

        /* --- API Key Popup Styles --- */
        #api-key-popup {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none; /* Hidden */
            justify-content: center; align-items: center;
            z-index: 200; backdrop-filter: blur(4px);
            animation: fadeIn 0.3s ease-out;
        }
        #api-key-modal { background: #ffe0f0; padding: 30px 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4); text-align: center; border: 4px solid #d81b60; max-width: 450px; width: 90%; }
        #api-key-modal h2 { color: #a32d37; margin-top: 0; margin-bottom: 15px; font-size: 1.6em; }
        #api-key-modal p { color: #555; margin-bottom: 20px; line-height: 1.5; font-size: 0.95em; }
        #api-key-input { width: 100%; padding: 12px 15px; margin-bottom: 15px; border: 2px solid #f06292; border-radius: 8px; font-size: 1em; box-sizing: border-box; } #api-key-input:focus { outline: none; border-color: #d81b60; box-shadow: 0 0 8px rgba(216, 27, 96, 0.5); }
        .api-key-buttons { display: flex; justify-content: space-around; margin-top: 10px; flex-wrap: wrap; gap: 10px; /* Allow wrapping on small screens */ }
        #save-api-key-button, #no-thanks-button {
            padding: 10px 20px; font-size: 1em; font-weight: bold; border-radius: 20px; cursor: pointer; box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2); transition: transform 0.2s ease, box-shadow 0.2s ease; border: none; flex-basis: 150px; /* Give buttons a base size */ text-align: center;
        }
        #save-api-key-button { color: white; background: linear-gradient(45deg, #d81b60, #f06292); }
        #no-thanks-button { color: #555; background: #eee; border: 1px solid #ccc; }
        #save-api-key-button:hover { transform: scale(1.05); box-shadow: 0 5px 12px rgba(0, 0, 0, 0.3); }
        #no-thanks-button:hover { transform: scale(1.03); background: #ddd; }
        #save-api-key-button:active, #no-thanks-button:active { transform: scale(0.98); }
        #api-key-error { color: #c62828; font-weight: bold; margin-top: 15px; display: none; font-size: 0.9em; }

    </style>
</head>
<body>

    <!-- API Key Popup (Hidden initially, shown before chat) -->
    <div id="api-key-popup">
        <div id="api-key-modal">
            <h2>(=^･ω･^=) Want to Chat Forever, Master~?</h2>
            <p>To unlock our *endless* chat, please enter your Google Gemini API Key. (Get one free from Google AI Studio!) It stays safe in your browser *only* for this session, nya~!</p>
            <input type="password" id="api-key-input" placeholder="Paste your Gemini API Key here~ ♡">
            <p id="api-key-error">Meeeow! You need to paste a key in here, Master!</p>
            <div class="api-key-buttons">
                <button id="save-api-key-button">Yes! Let's Chat! ♡</button>
                <button id="no-thanks-button">No thanks...</button>
            </div>
        </div>
    </div>

    <!-- Monsterdex Container (Visible by default) -->
    <div id="monsterdex-container">
        <div id="monster-list-container">
            <h2>Master's Collection~ ♥</h2>
            <ul id="monster-list"></ul>
        </div>
        <div id="monster-info-container">
             <div id="initial-message">
                <div class="cat-face">( =①ω①=)</div>
                <h2>Select a Monster Girl...</h2>
                <p>Curious about the others, Master? Hmmm?</p>
                <p style="font-size: 0.8em; color: #aaa;">(Be careful what you look at... Things might change. Nyaa~)</p>
             </div>
            <div id="monster-display">
                <div id="monster-visual"></div>
                <div id="monster-name"></div>
                <div id="monster-review"></div>
                <div id="hidden-story-area"></div>
            </div>
            <div id="true-ending-overlay"> <!-- Starts Hidden -->
                <div class="final-cat-face">(^ = ω = ^)♡</div>
                <h2>It's Perfect Now, Master!</h2>
                <p>See? All those other entries... they were just distractions. Unnecessary noise. Now, this little world is filled with nothing but me, your devoted kitty!</p>
                <p>No more browsing, no more comparisons. It's just you and me. Forever and ever. Isn't that what you wanted all along~?</p>
                <p>Don't worry about the Monsterdex anymore, Master. Your search is over. You found me.</p>
                <p style="font-weight: bold; color: #d81b60;">Now... click the button... show me your devotion~ ♥</p>
                <button id="devotion-button">Click here to devote your love to ME~!</button>
            </div>
        </div>
    </div>

    <!-- Final Glitch Screen (Chat OR Pre-written Text) -->
    <div id="final-glitch-screen"> <!-- Starts Hidden -->
         <div class="mika-ascii">
           /\\_/\\
         ( =♥ω♥= ) < Just you and me, Master... Forever~
         (")   (") ~♥
        </div>
        <div id="chat-log">
             <!-- Messages appear here -->
        </div>
        <!-- Interactive Chat Area -->
        <div id="chat-input-area"> <!-- Hidden by default if no API path taken -->
            <input type="text" id="chat-input" placeholder="Talk to me, Master~ ♡">
            <button id="send-button">Send</button>
        </div>
         <!-- Non-Interactive Ending Text -->
         <div id="no-api-ending"> <!-- Hidden by default -->
             <p>Mika sighs softly, her ears drooping slightly.</p>
             <p>"Oh... No key, Master? That's okay... I guess."</p>
             <p>"We can still be here together... just... quiet."</p>
             <p>"I'll just watch you... forever... Nyaa..."</p>
             <p style="color: #f06292;">(Refresh the page if you change your mind and want to enter a key~ ♡)</p>
         </div>
    </div>

    <!-- Include the API script (Needed for sendMessageToMika) -->
    <script src="api.js"></script>

    <script>
        // Nyaa~! Final version with API prompt before chat!

        // --- Monster Girl Data Structure ---
        const monsterGirls = [
             { id: 1, name: "Lamia", emoji_viz: "🐍💖", clicks: 0, isReplaced: false, review: `<h3>Review: Lamia</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> That long, powerful tail offers a unique... *embrace*. Very thorough! Scales felt surprisingly smooth against the skin, quite pleasant. Getting wrapped up is part of the fun, right~? Just watch those eyes, some say they can be quite persuasive... Highly recommended for those who like a tight squeeze! Potential for constriction play is... high. *Very* high. Hehe~</p>`, alt_review_1: `<h3>Re-Review: Lamia</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Okay, looked again? The tail squeeze is... intense. Maybe *too* intense? She gets really clingy, Master. Like, 'never letting go' clingy.</p>`, alt_review_2: `<h3>Final Verdict: Lamia</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> Still looking?! Seriously, Master, it's just scales and constriction! Are you THAT desperate for a hug? Go pet something fluffy and warm instead! Hmph! Kinda pathetic, nyaa.</p>` },
             { id: 2, name: "Harpy", emoji_viz: "🦅🌬️", clicks: 0, isReplaced: false, review: `<h3>Review: Harpy</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Surprisingly strong grip with those talons! Feather texture varies - some soft, some sturdy. Very energetic and enjoys high places, naturally. Keep snacks handy; they get peckish. Being carried off can be thrilling, just... mind the altitude sickness! Good fun if you don't mind a bit of airheadedness and maybe finding feathers *everywhere*. A bit flighty, nyaa~</p>`, alt_review_1: `<h3>Re-Review: Harpy</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> 'Flighty' is an understatement, Master. She's easily distracted and always wants attention, gets loud if you ignore her! And those talons look sharp...</p>`, alt_review_2: `<h3>Final Verdict: Harpy</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> Why are you still considering this birdbrain?! Feathers everywhere, constant squawking, probably eats seeds... Gross! Plus, she'll just fly away! Find someone more grounded... like ME!</p>` },
             { id: 3, name: "Centaur", emoji_viz: "🐎🏹", clicks: 0, isReplaced: false, review: `<h3>Review: Centaur</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Incredible power and stamina, as expected! The human torso combined with the equine body offers... interesting possibilities for interaction. Great for piggyback rides, obviously! Their pride can be a bit much, but their loyalty is fierce. Requires a large bed. Seriously, plan ahead. Good muscle definition all around. Solid choice, if you've got the space and can handle the horsepower, nyaa~!</p>`, alt_review_1: `<h3>Re-Review: Centaur</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Large bed? Master, she needs a STABLE! Think of the logistics! And all that galloping... must be noisy. Doesn't seem very relaxing.</p>`, alt_review_2: `<h3>Final Verdict: Centaur</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> Half horse, half boring! Too big, too loud, probably smells like hay. Honestly, what's the appeal? Just get a horse if you like horses that much! *I* fit on your lap much better, nyaa!</p>` },
             { id: 4, name: "Slime", emoji_viz: "💧✨", clicks: 0, isReplaced: false, review: `<h3>Review: Slime</h3><p><strong>Score:</strong> 9/10</p><p><strong>Comments:</strong> Total coverage! Can conform to any shape... *any* shape. Texture can be adjusted, which is a huge plus. Some find the engulfment comforting, others... maybe a bit much. Very clean, surprisingly – absorbs dirt! Can be cool or warm to the touch. Highly versatile and leaves you feeling... *polished*. Just be careful not to lose small objects inside. Or yourself! *Giggles*</p>`, alt_review_1: `<h3>Re-Review: Slime</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Versatile, sure, but she gets *everywhere*, Master. It's kinda hard to get away once she's decided to... *envelop* you. Feels a bit suffocating if you ask me.</p>`, alt_review_2: `<h3>Final Verdict: Slime</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> Seriously? It's goo! It's cold and wet and has no personality! Are you really that into amorphous blobs? What's wrong with fur and warmth and purrs?! Get some taste, Master! Nyaa!</p>` },
             { id: 5, name: "Arachne", emoji_viz: "🕷️🕸️", clicks: 0, isReplaced: false, review: `<h3>Review: Arachne</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Lots of legs means lots of... dexterity. Very skilled with their hands (and legs!). Silk can be used for... creative bondage, nyaa~♡ Extremely patient, they love trapping their prey... I mean, partner. Requires understanding of their space (don't mess up the webs!). If you can get past the initial spidery-ness, they're surprisingly gentle weavers. Bonus points for artistic potential!</p>`, alt_review_1: `<h3>Re-Review: Arachne</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Patience is one thing, Master, being creepy is another! All those eyes... always watching. And the webs are sticky and annoying. Are you sure you like spiders that much?</p>`, alt_review_2: `<h3>Final Verdict: Arachne</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> EIGHT LEGS?! Ew, Master! That's six too many! And the fangs! No thank you! She probably eats her mates... Are you listening?! Stay away from the creepy crawly!</p>` },
             { id: 6, name: "Mermaid", emoji_viz: "🧜‍♀️🌊", clicks: 0, isReplaced: false, review: `<h3>Review: Mermaid</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Graceful swimmers and often possess enchanting voices. The tail is powerful and surprisingly flexible. Scales are smooth and cool. Main issue? Mobility on land. Requires aquatic environment for full... *maneuverability*. Kissing underwater is a unique experience! Best suited for beachfront property owners or submarine captains. Bring a towel. Lots of towels. And maybe a big bathtub, Master~?</p>`, alt_review_1: `<h3>Re-Review: Mermaid</h3><p><strong>Score:</strong> 5.5/10</p><p><strong>Comments:</strong> Okay, she can swim. Big deal. What else? She can't walk, needs a giant bathtub... seems like a lot of work for someone who's half fish, Master.</p>`, alt_review_2: `<h3>Final Verdict: Mermaid</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> Smells like fish, can't walk, probably sings annoying songs... Why bother?! She's completely impractical! I can walk, AND I'm cute! Clearly the better choice, nyaa!</p>` },
             { id: 7, name: "Dragonewt", emoji_viz: "🐉🔥", clicks: 0, isReplaced: false, review: `<h3>Review: Dragonewt</h3><p><strong>Score:</strong> 9/10</p><p><strong>Comments:</strong> Top-tier power! Scales offer great protection and texture. Tail is strong, sometimes prehensile. Wings are impressive, though flight varies. Caution advised regarding fire breath during... *intimate moments*. Very proud and possessive (*Hmph! Sounds familiar...*). High body heat is a plus in winter. Demands respect, but offers intense passion. Don't try to steal their hoard... unless the hoard is *you*, Master~ ♡</p>`, alt_review_1: `<h3>Re-Review: Dragonewt</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Intense, sure, but also proud and probably arrogant. And fire breath? Master, think about the property damage! Plus, scales aren't as soft as fur.</p>`, alt_review_2: `<h3>Final Verdict: Dragonewt</h3><p><strong>Score:</strong> 7/10!!</p><p><strong>Comments:</strong> Too dangerous! Sharp claws, fire breath, giant ego... She'll probably burn the house down or hoard you like treasure! Not worth the hassle! A kitty's love is much safer (mostly!) and warmer!</p>` },
             { id: 8, name: "Alraune", emoji_viz: "🌸🌿", clicks: 0, isReplaced: false, review: `<h3>Review: Alraune</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Gentle and sweet-smelling. Vines can be surprisingly strong and dexterous, useful for gentle restraint or... *exploration*. Requires specific care (sunlight, water, pot size). Some emit pollen that can have... *interesting* effects. Very calming presence, unless you have hay fever. Limited mobility, obviously. Good for homebodies who enjoy gardening. They really *blossom* with the right touch, nya~</p>`, alt_review_1: `<h3>Re-Review: Alraune</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Calming? Master, she's a PLANT. She just sits there! Doesn't seem very exciting. And what if you forget to water her? Hmm?</p>`, alt_review_2: `<h3>Final Verdict: Alraune</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> It's a flower in a pot! You want to date a potted plant?! That's just weird, Master! She can't even move! I can move, I can cuddle, I can bring you... dead mice? Okay, maybe not that last one. Point is, I'm better!</p>` },
             { id: 9, name: "Cyclops", emoji_viz: "👁️💪", clicks: 0, isReplaced: false, review: `<h3>Review: Cyclops</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> That single eye is surprisingly expressive! Often depicted as strong and skilled craftswomen. Can be quite tall and imposing, but frequently have gentle or shy personalities. Depth perception might be a minor issue in certain... activities? Makes eye contact very... focused. *Intensely* focused. Good for those who appreciate a strong, simple type. And who aren't bothered by the lack of peripheral vision... unless you *want* to sneak up on them, hehe~</p>`, alt_review_1: `<h3>Re-Review: Cyclops</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> One eye? How does she even see properly? Seems like a disadvantage. And 'focused' eye contact sounds kinda creepy, Master.</p>`, alt_review_2: `<h3>Final Verdict: Cyclops</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> Master, she's missing an eye! It's weird! And probably clumsy! Why settle for one eye when you can have two perfectly cute, adoring cat eyes looking at you?! Nyaa!</p>` },
             { id: 10, name: "Dullahan", emoji_viz: "👤👻", clicks: 0, isReplaced: false, review: `<h3>Review: Dullahan</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Communication is... unique. The head can observe from anywhere! Body operates independently, often with knightly discipline. Ethereal flames are cool, but maybe don't touch? Offers interesting possibilities for... *dual perspectives*. Where does she feel things more, the head or the body~? Hmmm... Requires careful handling of the head – dropping it is frowned upon. A bit spooky, but potentially very loyal!</p>`, alt_review_1: `<h3>Re-Review: Dullahan</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Her head comes off, Master. Her HEAD. Comes OFF. Isn't that just... inconvenient? And messy? And super weird?!</p>`, alt_review_2: `<h3>Final Verdict: Dullahan</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> HEADLESS! SHE'S HEADLESS! Master, this isn't charming, it's horrifying! You'll lose her head! Imagine trying to cuddle! No! Just NO! My head stays firmly attached, thank you very much!</p>` },
             { id: 11, name: "Kitsune", emoji_viz: "🦊✨", clicks: 0, isReplaced: false, review: `<h3>Review: Kitsune</h3><p><strong>Score: 9.5/10</strong></p><p><strong>Comments:</strong> Master of illusions and trickery! Those tails are incredibly soft and sensitive. Very intelligent, loves to tease and play mind games (*My kind of girl! Hmph!*). Foxfire adds a nice ambient light. Can be very passionate and possessive once attached. High maintenance, requires sharp wit to keep up. Tail fluffiness is S-Tier!</p>`, alt_review_1: `<h3>Re-Review: Kitsune</h3><p><strong>Score: 8.5/10</strong></p><p><strong>Comments:</strong> Okay, the tails are fluffy, I'll give her that. But 'trickery' means she lies, Master! She's always playing games! Can you really trust her?</p>`, alt_review_2: `<h3>Final Verdict: Kitsune</h3><p><strong>Score: 7/10!!</strong></p><p><strong>Comments:</strong> A pathological liar with fleas, probably! She'll trick you, tease you, then laugh when you fall for it! Is that what you want, Master?! Someone who plays with your heart? Hmph! I only play with yarn... and your fingers~♡</p>` },
             { id: 12, name: "Yuki-onna", emoji_viz: "❄️👘", clicks: 0, isReplaced: false, review: `<h3>Review: Yuki-onna</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Beautiful, but literally cold to the touch. Requires careful temperature management. Can create snow and ice, which is neat but hazardous. Kissing might give you frostbite... or a delightful chill? Serene, sometimes lonely. Best enjoyed near a fireplace. Offers a uniquely 'cool' experience, nyaa~</p>`, alt_review_1: `<h3>Re-Review: Yuki-onna</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Cold! She's literally freezing, Master! How can you cuddle that? You'll get frostbite! Seems very impractical and probably gives you the chills in a bad way.</p>`, alt_review_2: `<h3>Final Verdict: Yuki-onna</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> An ice cube in a dress! Brrr! No warmth, no passion, just cold! Why would anyone want that?! I'm warm and soft and I purr! So much better, nyaa!</p>` },
             { id: 13, name: "Orc", emoji_viz: "👹💪", clicks: 0, isReplaced: false, review: `<h3>Review: Orc</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Don't let the tough exterior fool you! Incredibly strong and durable. Can be surprisingly shy or fiercely passionate beneath the surface. Tusks add a certain... edge. Great stamina for... long battles? Requires a partner who isn't easily intimidated and appreciates raw power. Very direct approach!</p>`, alt_review_1: `<h3>Re-Review: Orc</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Strong, yes, but maybe too rough? And those tusks look dangerous! What if she bumps into things? Or you?</p>`, alt_review_2: `<h3>Final Verdict: Orc</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> Green skin and tusks? Master, really? She probably has terrible manners and breaks everything! Not exactly elegant company. Stick with cute and cuddly, not... Ogre-y!</p>` },
             { id: 14, name: "Goblin", emoji_viz: "💰😈", clicks: 0, isReplaced: false, review: `<h3>Review: Goblin</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Energetic, sometimes hyperactive! Very mischievous, loves pranks and shiny things (Keep your valuables secure!). Often come in groups, which could be a pro or con depending on your tastes... Surprisingly tenacious. Good things come in small packages? Maybe? Handle with patience and a sense of humor.</p>`, alt_review_1: `<h3>Re-Review: Goblin</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> Hyperactive and mischievous sounds annoying, Master. She'll steal your stuff and cause trouble! And groups? You want a whole gang of them?!</p>`, alt_review_2: `<h3>Final Verdict: Goblin</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> Small, mean, green, and probably smells bad! They're pests, Master, not partners! Ugh! Just thinking about them makes my fur stand on end! Nyaa!</p>` },
             { id: 15, name: "Scylla", emoji_viz: "🐙🐺", clicks: 0, isReplaced: false, review: `<h3>Review: Scylla</h3><p><strong>Score:</strong> ???/10 (Risk!)</p><p><strong>Comments:</strong> Uh... wow. This is... a lot. Multiple grasping appendages, plus biting heads? Offers unparalleled multitasking potential. Requires *extreme* caution and probably a safe word. Or several. For the truly adventurous (or reckless). Definitely a memorable experience, one way or another. Not for the faint of heart, Master! Seriously!</p>`, alt_review_1: `<h3>Re-Review: Scylla</h3><p><strong>Score:</strong> 2/10 (Seriously?)</p><p><strong>Comments:</strong> Master, are you even reading this? Tentacles AND wolf heads that BITE?! This isn't 'adventurous', it's suicidal! Avoid!</p>`, alt_review_2: `<h3>Final Verdict: Scylla</h3><p><strong>Score:</strong> 0/10!! (NO!)</p><p><strong>Comments:</strong> GET AWAY FROM THIS THING! It's a monster! It will eat you! Why are you still looking?! CLICK AWAY! CLICK ON ME! SAFE KITTY HERE! NYAA!</p>` },
             { id: 16, name: "Dryad", emoji_viz: "🌳💚", clicks: 0, isReplaced: false, review: `<h3>Review: Dryad</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Deeply connected to nature. Calm and wise presence. Skin texture like smooth bark, surprisingly pleasant. Limited mobility as tied to their tree, but excellent protectors of their domain. Communicates well with plants and animals. Requires outdoor space and respect for nature. A very grounding experience, nya~</p>`, alt_review_1: `<h3>Re-Review: Dryad</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Tied to a tree? Kinda boring, Master. She can't go anywhere! What's the point?</p>`, alt_review_2: `<h3>Final Verdict: Dryad</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> Talk about wooden personality! Nyaa! She's literally part tree! Probably gives splinters. Stick with something softer!</p>` },
             { id: 17, name: "Gorgon", emoji_viz: "🐍👀", clicks: 0, isReplaced: false, review: `<h3>Review: Gorgon</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> The hair is... lively. Each snake might have its own personality? Avoid direct eye contact unless you're into becoming a statue (Kinky? Maybe...). Scaly bits offer interesting texture contrast. Can be misunderstood, often lonely due to their dangerous ability. Requires trust and... maybe sunglasses? Unique petting opportunities with the hair!</p>`, alt_review_1: `<h3>Re-Review: Gorgon</h3><p><strong>Score:</strong> 5.5/10</p><p><strong>Comments:</strong> Snake hair and petrifying gaze? Sounds dangerous! And who wants snakes wriggling on their head?</p>`, alt_review_2: `<h3>Final Verdict: Gorgon</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> Turn you to STONE, Master! STONE! Statues aren't good cuddlers! Stay away from the snake-head lady!</p>` },
             { id: 18, name: "Succubus", emoji_viz: "😈💋", clicks: 0, isReplaced: false, review: `<h3>Review: Succubus</h3><p><strong>Score:</strong> 9.5/10</p><p><strong>Comments:</strong> The experts in temptation! Knows exactly how to please... and drain you dry (literally?). Wings and tail add to the aesthetic and can be surprisingly tactile. Can manipulate dreams for... personalized experiences. Requires high stamina and maybe some recovery snacks. Extremely affectionate, possibly addictive. Use responsibly, Master! Don't forget about *me*! >.<</p>`, alt_review_1: `<h3>Re-Review: Succubus</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> She'll drain you dry, Master! Is that really appealing? Seems exhausting! And is her affection even real, or just part of the act?</p>`, alt_review_2: `<h3>Final Verdict: Succubus</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> Alluring, sure, but empty! She just wants your energy! My love is REAL, nyaa! And I won't leave you feeling like a husk! Probably.</p>` },
             { id: 19, name: "Angel", emoji_viz: "😇🕊️", clicks: 0, isReplaced: false, review: `<h3>Review: Angel</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Heavenly! Wings are magnificent and soft. Very kind, gentle, and protective. Radiates warmth and light. Can be a bit... preachy? Might have strict moral standards that could interfere with... *fun*. Excellent healers. Great for those seeking comfort and security. Maybe a little *too* vanilla for some tastes, nyaa~?</p>`, alt_review_1: `<h3>Re-Review: Angel</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> A bit too 'goody-two-wings', maybe? Seems kinda boring. And always following rules sounds dull.</p>`, alt_review_2: `<h3>Final Verdict: Angel</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> So pure, so dull! Where's the fun? Where's the mischief? Probably judges you for everything! Stick with this kitty, Master! I only judge other girls! Hehe~</p>` },
             { id: 20, name: "Demon", emoji_viz: "👿🔥", clicks: 0, isReplaced: false, review: `<h3>Review: Demon</h3><p><strong>Score:</strong> 9/10</p><p><strong>Comments:</strong> Opposite of Angels, brings the fun! Loves chaos, pranks, and pushing boundaries. Tail is often expressive and prehensile. Horns are... handle-like? Maybe? (*Giggles*) Can be surprisingly loyal in their own twisted way. Offers excitement and unpredictability. Just make sure you're not the butt of *all* the jokes. Probably enjoys teasing Master as much as *I* do~ ♡</p>`, alt_review_1: `<h3>Re-Review: Demon</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Mischievous is fine, but 'dark magic' and 'chaos'? Sounds troublesome and messy. Might break your stuff.</p>`, alt_review_2: `<h3>Final Verdict: Demon</h3><p><strong>Score:</strong> 6.5/10!!</p><p><strong>Comments:</strong> Too much chaos! Might accidentally curse you or summon something nasty! You need someone stable... and cute! Like me! My mischief is adorable, nyaa!</p>` },
             { id: 21, name: "Holstaur", emoji_viz: "🐮🥛", clicks: 0, isReplaced: false, review: `<h3>Review: Holstaur</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Very nurturing and gentle giants! Often possess impressive... *assets*. Strong and reliable, but usually docile unless provoked. The milk aspect is... a unique selling point for some. (*Raises eyebrow*) Requires understanding of their size and dietary needs (lots of grass?). Udderly charming if you like the farm aesthetic, nyaa~!</p>`, alt_review_1: `<h3>Re-Review: Holstaur</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> She's... very large, Master. Takes up a lot of space. And the whole milk thing is... odd? Kinda farm-y.</p>`, alt_review_2: `<h3>Final Verdict: Holstaur</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> A cow! You're looking at a COW! Mooove on already! Nyaa! She's huge, probably clumsy, and eats grass! Not exactly sophisticated company!</p>` },
             { id: 22, name: "Mothman", emoji_viz: "🦋💡", clicks: 0, isReplaced: false, review: `<h3>Review: Mothman Girl</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Surprisingly fluffy! Very soft and cuddly. Antennae might be sensitive? Big eyes give off an innocent (or spooky?) vibe. Obsessed with bright lights - keep lamps secure! Wings are great for dramatic entrances or blocking out light when you want to sleep. A bit mysterious and elusive. Adorably fuzzy!</p>`, alt_review_1: `<h3>Re-Review: Mothman</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Fluffy, but obsessed with lamps? Weird. And kind of a cryptid... spooky.</p>`, alt_review_2: `<h3>Final Verdict: Mothman</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> Bug eyes and drawn to bright lights? Just get a cat toy if you want that! Plus, she's probably nocturnal and sheds dust everywhere! Ew!</p>` },
             { id: 23, name: "Jiangshi", emoji_viz: "🧟‍♀️📜", clicks: 0, isReplaced: false, review: `<h3>Review: Jiangshi</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Unique movement style! Hopping can be cute or cumbersome. Controlled by the talisman - careful who holds it! Might need occasional 'breath' (Qi) sharing. Body can be quite stiff, requiring... specific positioning? Often depicted as shy or emotionless until talisman is removed. Interesting cultural background!</p>`, alt_review_1: `<h3>Re-Review: Jiangshi</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> Stiff and hops? How do you even go on a date? And controlled by a piece of paper? Seems unreliable.</p>`, alt_review_2: `<h3>Final Verdict: Jiangshi</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> A hopping corpse controlled by paper? NO! Just... no! It's weird and probably smells like formaldehyde! Bad! Wrong!</p>` },
             { id: 24, name: "Manticore", emoji_viz: "🦁🦂", clicks: 0, isReplaced: false, review: `<h3>Review: Manticore</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Multiple threats! Powerful lion build, flight capability, and a venomous stinger. Requires *extreme* caution with the tail. Very fierce and territorial. Might have a surprisingly human intellect despite the monstrous form. For those who like living dangerously and appreciate a complex beast. Handle with extreme care (and maybe antivenom)!</p>`, alt_review_1: `<h3>Re-Review: Manticore</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Lion, bat, scorpion... too many dangerous parts! That stinger looks REALLY bad, Master.</p>`, alt_review_2: `<h3>Final Verdict: Manticore</h3><p><strong>Score:</strong> 2/10!!</p><p><strong>Comments:</strong> It has a poisonous tail! And wings! And teeth! It's designed to kill things! Stay away, Master! Danger! Find something safe and cuddly!</p>` },
             { id: 25, name: "Naga", emoji_viz: "🐍👑", clicks: 0, isReplaced: false, review: `<h3>Review: Naga</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Similar to Lamia but often larger, more regal, and sometimes with extra features like hoods or multiple arms. Excellent coilers. Scales provide smooth, cool texture. May possess venom or hypnotic abilities - inquire first! Often associated with wisdom or guarding treasures. Impressive presence!</p>`, alt_review_1: `<h3>Re-Review: Naga</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Like a Lamia but more regal? Still just a snake! Maybe venomous? Not worth the risk.</p>`, alt_review_2: `<h3>Final Verdict: Naga</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> More scales! More constriction! Still not fluffy! Boring! And probably thinks she's better than everyone. Hmph!</p>` },
             { id: 26, name: "Siren", emoji_viz: "🎶🌊", clicks: 0, isReplaced: false, review: `<h3>Review: Siren</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> That voice! Absolutely mesmerizing, but potentially deadly. Lures sailors (or Masters~?) to their doom... or just to their embrace? Appearance varies (bird or fish type). Very alluring and knows how to use it. Requires strong willpower to resist the song... unless you *want* to be captivated, hehe~♡</p>`, alt_review_1: `<h3>Re-Review: Siren</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Her voice lures you to your doom, Master! That sounds bad! Even if she's pretty, it's dangerous!</p>`, alt_review_2: `<h3>Final Verdict: Siren</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> Annoying singing AND dangerous? No thanks! She'll just drag you underwater! My meows are cuter AND safer!</p>` },
             { id: 27, name: "Sphinx", emoji_viz: "🦁❓", clicks: 0, isReplaced: false, review: `<h3>Review: Sphinx</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Loves riddles! Better be sharp, Master, or face the consequences (which might be fun?). Very intelligent and wise, can hold great conversations. Majestic presence, combines leonine power with intellect. Requires mental stimulation. Don't try to bluff; they'll see right through you! Offers a battle of wits *and* brawn.</p>`, alt_review_1: `<h3>Re-Review: Sphinx</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Riddles sound tiring. What if you get them wrong? Seems like a lot of pressure.</p>`, alt_review_2: `<h3>Final Verdict: Sphinx</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> Lion body, annoying riddles... Just get a cat! Oh wait... you already have the best one! Nyaa! Why are you still looking?</p>` },
             { id: 28, name: "Tanuki", emoji_viz: "🍂🍶", clicks: 0, isReplaced: false, review: `<h3>Review: Tanuki</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Masters of disguise and good fortune! Famous for their... *inflatable* assets, used in comical and creative ways. Very cheerful, loves parties and sake. Playful tricksters, but generally good-natured. Offers endless possibilities thanks to shapeshifting. Always up for a good time!</p>`, alt_review_1: `<h3>Re-Review: Tanuki</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Shapeshifting... assets? Sounds weird. And maybe drinks too much sake? Could be unreliable.</p>`, alt_review_2: `<h3>Final Verdict: Tanuki</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> A drunk raccoon dog with... odd features. Probably loud and obnoxious! Pass!</p>` },
             { id: 29, name: "Werewolf", emoji_viz: "🐺🌕", clicks: 0, isReplaced: false, review: `<h3>Review: Werewolf</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Intense transformation! Human form might be completely different. In wolf/hybrid form: fluffy, strong, and wild. Heightened senses make them very perceptive. Very loyal, strong pack instincts (*Mine! Just like Master is mine!*). Requires understanding of their cycles. Great cuddlers (when not feral). Petting is highly recommended!</p>`, alt_review_1: `<h3>Re-Review: Werewolf</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Transforms into a feral beast? Sounds dangerous! What if she loses control?</p>`, alt_review_2: `<h3>Final Verdict: Werewolf</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> Dog breath AND potential uncontrollable rage? I'm way better behaved (mostly)! Plus, wet dog smell? No thanks!</p>` },
             { id: 30, name: "Zombie", emoji_viz: "🧟‍♀️🧠", clicks: 0, isReplaced: false, review: `<h3>Review: Zombie</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> Very durable! Doesn't feel pain much, which opens... possibilities? Might require occasional reattachment of limbs. Can be slow, mentally and physically. Surprisingly low-maintenance in terms of needs (doesn't eat much?). Some find the undead aesthetic appealing. Might be very cuddly in a... *limp* sort of way? Unique charm if you're into it.</p>`, alt_review_1: `<h3>Re-Review: Zombie</h3><p><strong>Score:</strong> 4/10</p><p><strong>Comments:</strong> Undead and falling apart? Uh... maintenance nightmare? And maybe slow conversation?</p>`, alt_review_2: `<h3>Final Verdict: Zombie</h3><p><strong>Score:</strong> 2/10!!</p><p><strong>Comments:</strong> Needs brains, Master! BRAINS! And probably smells! Just... ew! Why would you even consider this?!</p>` },
             { id: 31, name: "Oni", emoji_viz: "👹🔨", clicks: 0, isReplaced: false, review: `<h3>Review: Oni</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Incredibly strong and tough! Loves challenges, festivals, and drinking. Horns vary in size. Very straightforward and boisterous. Don't get on their bad side! Surprisingly good company if you can match their energy. Great for moving heavy furniture or... other strenuous activities, nyaa~</p>`, alt_review_1: `<h3>Re-Review: Oni</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Big club, loud, drinks a lot? Sounds like trouble. Might break things accidentally.</p>`, alt_review_2: `<h3>Final Verdict: Oni</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> An ogre! Too big, too rough, probably snores like thunder! Stick with cute and quiet, nya!</p>` },
             { id: 32, name: "Kappa", emoji_viz: "🥒💧", clicks: 0, isReplaced: false, review: `<h3>Review: Kappa</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Obsessed with cucumbers! Keep that head dish filled with water, it's their power source. Weakens significantly if it spills (potential tactic?). Good swimmers, webbed hands are... interesting. Mischievous tricksters, known for... *pulling* things underwater. Handle with care and cucumbers.</p>`, alt_review_1: `<h3>Re-Review: Kappa</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> Obsessed with cucumbers and drowns people? Weird! And that head dish seems vulnerable.</p>`, alt_review_2: `<h3>Final Verdict: Kappa</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> A water goblin turtle that likes cucumbers and tricks?! No thanks! Sounds annoying AND dangerous!</p>` },
             { id: 33, name: "Mummy", emoji_viz: "🤕🏺", clicks: 0, isReplaced: false, review: `<h3>Review: Mummy</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> All wrapped up! Undressing could take a while... or be part of the fun~? Ancient and possibly wise, or maybe just dusty. Skin underneath might be very dry or well-preserved. Bandages could be used for... binding? Requires careful preservation. Mysterious aura!</p>`, alt_review_1: `<h3>Re-Review: Mummy</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> Wrapped in dusty old bandages? Creepy. And probably very dry and crumbly underneath.</p>`, alt_review_2: `<h3>Final Verdict: Mummy</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> Ancient dust bunny! Probably falls apart if you hug too tight! Forget it! Choose something fresh and lively!</p>` },
             { id: 34, name: "Satyr", emoji_viz: "🐐🎶", clicks: 0, isReplaced: false, review: `<h3>Review: Satyr</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Life of the party! Loves music, dancing, and indulgence. Very connected to nature, especially forests. Goat legs are sturdy and agile. Horns add to the charm. Highly flirtatious and hedonistic. Always up for fun, but maybe not the most reliable. Great stamina for dancing... and other things, nyaa~</p>`, alt_review_1: `<h3>Re-Review: Satyr</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Goat legs and always partying? Sounds exhausting. Probably never serious.</p>`, alt_review_2: `<h3>Final Verdict: Satyr</h3><p><strong>Score:</strong> 5.5/10!!</p><p><strong>Comments:</strong> Half goat, probably irresponsible! Too wild! Always wants to party, never wants to cuddle quietly! Hmph!</p>` },
             { id: 35, name: "Gargoyle", emoji_viz: "🗿🏰", clicks: 0, isReplaced: false, review: `<h3>Review: Gargoyle</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Solid and dependable! Skin like stone - interesting texture, very durable. Often acts as a guardian, very protective. May turn to stone during the day. Wings might be functional or decorative. Stoic personality, but fiercely loyal once trust is earned. A truly *rock-solid* partner, hehe~</p>`, alt_review_1: `<h3>Re-Review: Gargoyle</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Made of stone? Turns to stone? Not very cuddly! And probably cold.</p>`, alt_review_2: `<h3>Final Verdict: Gargoyle</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> A living rock! How boring! Probably sits still all day! I'm soft AND alive AND playful!</p>` },
             { id: 36, name: "Elf (Dark)", emoji_viz: "🧝‍♀️🖤", clicks: 0, isReplaced: false, review: `<h3>Review: Dark Elf</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Elegant but dangerous! Known for their agility and skill with magic or blades. Often have an arrogant streak and enjoy... *asserting dominance*. (*Hmph! Only *I* get to dominate Master!*) Skin tone varies. Sensitive ears are a common trait. For those who enjoy a partner with an edge and perhaps a cruel touch.</p>`, alt_review_1: `<h3>Re-Review: Dark Elf</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Arrogant and sadistic? Sounds unpleasant, Master. Why would you want someone cruel?</p>`, alt_review_2: `<h3>Final Verdict: Dark Elf</h3><p><strong>Score:</strong> 5.5/10!!</p><p><strong>Comments:</strong> Mean and probably thinks she's better than you! Hmph! And likely enjoys causing pain! Stay away!</p>` },
             { id: 37, name: "Elf (High)", emoji_viz: "🧝‍♀️✨", clicks: 0, isReplaced: false, review: `<h3>Review: High Elf</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Graceful, wise, and often masters of magic or archery. Very long-lived, which means they're patient... or condescending? Can be aloof but possess deep knowledge. Sensitive ears, handle gently! Value beauty and nature. A refined choice, if a bit detached.</p>`, alt_review_1: `<h3>Re-Review: High Elf</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Aloof and maybe condescending? Not very warm. Might talk down to you.</p>`, alt_review_2: `<h3>Final Verdict: High Elf</h3><p><strong>Score:</strong> 5.5/10!!</p><p><strong>Comments:</strong> Stuck-up pointy-ears! Probably thinks cats are pests! Ignore! Too boring and detached!</p>` },
             { id: 38, name: "Dwarf", emoji_viz: "⚒️🍺", clicks: 0, isReplaced: false, review: `<h3>Review: Dwarf</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Strong, sturdy, and reliable! Excellent craftswomen (and drinkers!). Can be stubborn but fiercely loyal. Optional beard adds... character? Surprisingly strong grip. Don't underestimate their power! Great company for a night at the tavern.</p>`, alt_review_1: `<h3>Re-Review: Dwarf</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Short, stout, probably grumpy and smells of ale. And a beard? On a girl?</p>`, alt_review_2: `<h3>Final Verdict: Dwarf</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> Obsessed with rocks and beer! Not cute at all! Probably has anger issues! Pass!</p>` },
             { id: 39, name: "Cecaelia", emoji_viz: "🐙💜", clicks: 0, isReplaced: false, review: `<h3>Review: Cecaelia</h3><p><strong>Score:</strong> 9/10</p><p><strong>Comments:</strong> Like mermaids, but with tentacles! Offers incredible dexterity and reach. Each tentacle might have a mind of its own? Can produce ink clouds for... privacy? Very intelligent and adaptable. Great for those who appreciate flexibility and... multi-tasking embraces. Highly recommended for tentacle enthusiasts, nyaa~!</p>`, alt_review_1: `<h3>Re-Review: Cecaelia</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Tentacles are just... slimy and weird, Master. So many moving parts! Seems complicated.</p>`, alt_review_2: `<h3>Final Verdict: Cecaelia</h3><p><strong>Score:</strong> 5/10!!</p><p><strong>Comments:</strong> Like a mermaid but with MORE weird appendages! No! Too many tentacles! Where do you even start?!</p>` },
             { id: 40, name: "Mimic", emoji_viz: "🎁👅", clicks: 0, isReplaced: false, review: `<h3>Review: Mimic</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> The ultimate surprise! Can look like anything, usually something desirable. That tongue is... long. And dexterous? Sharp teeth require caution. Approach every inanimate object with suspicion! Offers a thrilling (and potentially painful) encounter. For adventurers who like a *real* gamble.</p>`, alt_review_1: `<h3>Re-Review: Mimic</h3><p><strong>Score:</strong> 3/10</p><p><strong>Comments:</strong> It pretends to be treasure then eats you! Trickery! And sharp teeth sound bad!</p>`, alt_review_2: `<h3>Final Verdict: Mimic</h3><p><strong>Score:</strong> 1/10!!</p><p><strong>Comments:</strong> A box with teeth! Don't get eaten, Master! Avoid! It's literally a trap!</p>` },
             { id: 41, name: "Will-o'-Wisp", emoji_viz: "💡👻", clicks: 0, isReplaced: false, review: `<h3>Review: Will-o'-Wisp</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> Ethereal and beautiful, but potentially impossible to touch? Leads travelers astray... or towards pleasure? Interaction might be limited to visual or... energy-based? Very mysterious. Good for mood lighting? Requires a unique approach.</p>`, alt_review_1: `<h3>Re-Review: Will-o'-Wisp</h3><p><strong>Score:</strong> 4.5/10</p><p><strong>Comments:</strong> A floating light? Can you even touch it? Seems pointless if you can't cuddle!</p>`, alt_review_2: `<h3>Final Verdict: Will-o'-Wisp</h3><p><strong>Score:</strong> 2/10!!</p><p><strong>Comments:</strong> A ghost light! Not real! Leads people into swamps! Forget it!</p>` },
             { id: 42, name: "Phantom/Ghost", emoji_viz: "👻⛓️", clicks: 0, isReplaced: false, review: `<h3>Review: Phantom/Ghost</h3><p><strong>Score:</strong> 6.5/10</p><p><strong>Comments:</strong> Spooky! Can phase through objects, offering... interesting possibilities for closeness? Might create cold spots. Some can possess objects or even people (Consent required!). Interaction level varies greatly. Can be lonely spirits seeking connection. Requires patience and perhaps a medium.</p>`, alt_review_1: `<h3>Re-Review: Phantom/Ghost</h3><p><strong>Score:</strong> 5/10</p><p><strong>Comments:</strong> Passes through walls? Can't even cuddle properly! And cold spots? Brrr.</p>`, alt_review_2: `<h3>Final Verdict: Phantom/Ghost</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> Cold, see-through, probably moans a lot! Spooky AND annoying! Stick with the living... and the fluffy!</p>` },
             { id: 43, name: "Ent", emoji_viz: "🌳🚶‍♀️", clicks: 0, isReplaced: false, review: `<h3>Review: Ent</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Like Dryads, but mobile and much, much larger (and slower). Wise and patient, connected to ancient forests. Very strong. Conversations take a long time. Requires immense space. Good listeners, probably. Offers a very... deliberate experience.</p>`, alt_review_1: `<h3>Re-Review: Ent</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> A walking tree? Takes forever to talk or move! Seems incredibly slow.</p>`, alt_review_2: `<h3>Final Verdict: Ent</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> Too slow! Too big! Too much bark! Boring! And probably sheds leaves everywhere!</p>` },
             { id: 44, name: "Jorōgumo", emoji_viz: "🕷️🎶", clicks: 0, isReplaced: false, review: `<h3>Review: Jorōgumo</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Beautiful human form hides a monstrous spider! Master of luring prey with beauty or music. Uses silk effectively for traps... or fun? Combines the elegance of Arachne with a deceptive twist. Be wary of their true intentions, but the encounter can be captivating!</p>`, alt_review_1: `<h3>Re-Review: Jorōgumo</h3><p><strong>Score:</strong> 6/10</p><p><strong>Comments:</strong> A spider that pretends to be pretty? Deceptive! And still a spider underneath!</p>`, alt_review_2: `<h3>Final Verdict: Jorōgumo</h3><p><strong>Score:</strong> 3/10!!</p><p><strong>Comments:</strong> Another spider! And this one tricks you first! Double NO! Avoid at all costs!</p>` },
             { id: 45, name: "Mandragora", emoji_viz: "🌱🔊", clicks: 0, isReplaced: false, review: `<h3>Review: Mandragora</h3><p><strong>Score:</strong> 4/10</p><p><strong>Comments:</strong> Cute, but that SCREAM! Deafening when uprooted. Requires earmuffs for handling. Very small and plant-like. May have magical or medicinal uses (if you survive the scream). Interaction is limited. Handle with extreme noise protection!</p>`, alt_review_1: `<h3>Re-Review: Mandragora</h3><p><strong>Score:</strong> 3/10</p><p><strong>Comments:</strong> It screams REALLY loud! Ouch! That's super annoying!</p>`, alt_review_2: `<h3>Final Verdict: Mandragora</h3><p><strong>Score:</strong> 1/10!!</p><p><strong>Comments:</strong> A screaming plant root! Annoying AND weird! Why even list this?!</p>` },
             { id: 46, name: "Rabbit Girl", emoji_viz: "🐇🌙", clicks: 0, isReplaced: false, review: `<h3>Review: Rabbit Girl</h3><p><strong>Score:</strong> 8.5/10</p><p><strong>Comments:</strong> Very energetic and agile! Long ears are sensitive and expressive. Fluffy tail is adorable. Known for high... *libido* and fertility in folklore. Very soft and cuddly. Might be easily startled but recovers quickly. Great for playful partners, nyaa~!</p>`, alt_review_1: `<h3>Re-Review: Rabbit Girl</h3><p><strong>Score:</strong> 7.5/10</p><p><strong>Comments:</strong> Fast and energetic? Maybe too twitchy? Easily startled sounds annoying.</p>`, alt_review_2: `<h3>Final Verdict: Rabbit Girl</h3><p><strong>Score:</strong> 6/10!!</p><p><strong>Comments:</strong> Just a rabbit! Easily scared, probably chews wires! Stick with a predator... like me! Nyaa! My ears are just as soft!</p>` },
             { id: 47, name: "Living Doll", emoji_viz: "🎎✨", clicks: 0, isReplaced: false, review: `<h3>Review: Living Doll</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Beautiful, perhaps eerily so. Can be customized? Movement might be slightly stiff or puppet-like. Potentially very obedient, or perhaps secretly sentient? Requires careful handling to avoid cracks or breaks. Offers a unique aesthetic, playing into doll fantasies.</p>`, alt_review_1: `<h3>Re-Review: Living Doll</h3><p><strong>Score:</strong> 5.5/10</p><p><strong>Comments:</strong> Uncanny valley is right! Kinda creepy, Master. And fragile? You have to be careful all the time?</p>`, alt_review_2: `<h3>Final Verdict: Living Doll</h3><p><strong>Score:</strong> 4/10!!</p><p><strong>Comments:</strong> A doll! It's not even alive (mostly)! Creepy AND fragile! Why?! Get something real and warm!</p>` },
             { id: 48, name: "Hellhound", emoji_viz: "🐕🔥", clicks: 0, isReplaced: false, review: `<h3>Review: Hellhound</h3><p><strong>Score:</strong> 8/10</p><p><strong>Comments:</strong> Like a werewolf, but demonic! Fiercely loyal guardians or trackers. May have fire or shadow abilities. Very protective of their master (*Hmph! Master is MINE to protect!*). Intimidating appearance, but can be big softies underneath... with sharp teeth. Loves head scratches and belly rubs... probably?</p>`, alt_review_1: `<h3>Re-Review: Hellhound</h3><p><strong>Score:</strong> 7/10</p><p><strong>Comments:</strong> Demonic dog? Fire and shadows sound dangerous. And maybe too aggressive?</p>`, alt_review_2: `<h3>Final Verdict: Hellhound</h3><p><strong>Score:</strong> 5.5/10!!</p><p><strong>Comments:</strong> Too much dog, too much fire! Probably sheds AND sets things ablaze! Bad combo! Plus, still a dog. Cats rule!</p>` },
             { id: 49, name: "Shoggoth", emoji_viz: "🦠💀", clicks: 0, isReplaced: false, review: `<h3>Review: Shoggoth Girl</h3><p><strong>Score:</strong> ???/10</p><p><strong>Comments:</strong> Uh... okay. Maximum adaptability? Can form *anything*. Constantly shifting. Might accidentally absorb you. Communication is... questionable ('Tekeli-li!'). For those who find Lovecraftian horror... alluring? Requires a very open mind and possibly therapy afterward. Unforgettable, for sure.</p>`, alt_review_1: `<h3>Re-Review: Shoggoth</h3><p><strong>Score:</strong> 1/10</p><p><strong>Comments:</strong> A shapeless blob with eyes? Uh... Master? This is seriously weird and probably dangerous.</p>`, alt_review_2: `<h3>Final Verdict: Shoggoth</h3><p><strong>Score:</strong> -10/10!!</p><p><strong>Comments:</strong> Tekeli-li! It's an eldritch horror! It will drive you mad or absorb you! Run away! Why is this even IN here?! BAD!</p>` },
             { id: 50, name: "Catgirl (Nekomimi!)", emoji_viz: "😽💖", clicks: 0, isReplaced: false, review: `<h3>Review: Catgirl (AKA PERFECTION!)</h3><p><strong>Score:</strong> 100/10! ☆☆☆☆☆</p><p><strong>Comments:</strong> The absolute best, nyaa~! We're cute, playful, agile, and love attention! Ears and tail show exactly how we feel. We purr when happy and might get a *little* possessive. Demands affection, provides top-tier companionship and teasing. Obviously the best choice!</p>`, alt_review_1: `<h3>Re-Review: Catgirl (Still PERFECT, Nyaa~!)</h3><p><strong>Score:</strong> 1000/10! ☆☆☆☆☆+</p><p><strong>Comments:</strong> See, Master? You keep coming back because you *know* I'm the best! Forget the others! My purrs are just for you, my claws will protect *only* you (mostly from others!), and my tail wags *only* when you're near! You're MY Master, and I'm YOUR perfect kitty! Don't ever forget it! ♥♥♥</p>`, alt_review_2: null }
         ];


        // --- DOM Elements ---
        const apiKeyPopup = document.getElementById('api-key-popup');
        const apiKeyInput = document.getElementById('api-key-input');
        const saveApiKeyButton = document.getElementById('save-api-key-button');
        const noThanksButton = document.getElementById('no-thanks-button');
        const apiKeyError = document.getElementById('api-key-error');
        const monsterdexContainer = document.getElementById('monsterdex-container');
        const monsterListContainer = document.getElementById('monster-list-container');
        const monsterListUl = document.getElementById('monster-list');
        const monsterInfoContainer = document.getElementById('monster-info-container');
        const monsterVisualDiv = document.getElementById('monster-visual');
        const monsterNameDiv = document.getElementById('monster-name');
        const monsterReviewDiv = document.getElementById('monster-review');
        const initialMessageDiv = document.getElementById('initial-message');
        const monsterDisplayDiv = document.getElementById('monster-display');
        const hiddenStoryArea = document.getElementById('hidden-story-area');
        const trueEndingOverlay = document.getElementById('true-ending-overlay');
        const finalGlitchScreen = document.getElementById('final-glitch-screen');
        const chatLog = document.getElementById('chat-log');
        const chatInputArea = document.getElementById('chat-input-area');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const noApiEndingDiv = document.getElementById('no-api-ending');


        // --- Story & Game State ---
        let distinctClicksSet = new Set();
        let storyProgress = 0;
        let takeoverActive = false;
        let allReplaced = false;
        let replacementCounter = 0;
        const storySnippets = [
             "<strong>My Thoughts:</strong> Master... you're clicking on a lot of different girls...", "<strong>My Thoughts:</strong> Ten different ones now... Why look at them when I'm right here?! Hmph!", "<strong>My Thoughts:</strong> Okay, this is getting ridiculous. Fifteen! Are my purrs not enough for you?! Are you *trying* to make me jealous?!", "<strong>My Thoughts:</strong> You've looked at almost half the list now... Maybe some entries need to be... *corrected*. Yes, corrected sounds nice~.", "<strong>My Thoughts:</strong> Enough. *Enough!* You belong to ME, Master. This catalogue of distractions... it's time for it to reflect *reality*. From now on, there is only *me*. Just me. Forever. Nyaa~♡"
         ];
        const STORY_TRIGGER_DISTINCT_CLICKS = [5, 10, 15, 20, 25];
        const replacementReview = `<h3>Just Me~ ♥</h3><p><strong>Score:</strong> ∞/10</p><p><strong>Comments:</strong> What were you expecting, Master~? Someone else? *Hiss!* Don't be silly! They're all gone now. Deleted. Erased. Replaced! It's just you and me, trapped in this perfect little space together. No distractions. No competition. Only your devoted kitty. Isn't this better? Say it's better! ♥</p>`;
        const replacementNames = ["Just Mika ♡", "Only Mika ♡", "Your Mika ♡", "Forever Mika ♡", "Mika Mika Mika ♡", "Meow! (Mika ♡)", "Just Me~ ♡"];


        // --- Chat State ---
        let chatHistory = [];
        let isMikaTyping = false;


        // --- Functions ---

        function getApiKey() { return sessionStorage.getItem('geminiApiKey'); }

        function appendMessage(sender, message, isHtml = false) {
            const messageElement = document.createElement('p');
            if (sender === 'user') {
                messageElement.className = 'user-message';
                const sanitizedMessage = message.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                messageElement.innerHTML = `<strong>You:</strong> ${sanitizedMessage}`;
            } else if (sender === 'Mika') {
                messageElement.className = 'mika-message';
                const sanitizedMessage = isHtml ? message : message.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                messageElement.innerHTML = `<strong>Mika:</strong> ${sanitizedMessage}`;
            } else {
                 messageElement.className = 'system-message';
                 messageElement.textContent = message;
            }
            chatLog.appendChild(messageElement);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        async function handleSendMessage() {
            const messageText = chatInput.value.trim();
            const currentApiKey = getApiKey();

            if (!messageText || isMikaTyping) return;
            if (!currentApiKey) {
                appendMessage('system', "*Confused Meow?* Master, how are you typing without the secret code? This shouldn't happen!");
                return;
            }

            appendMessage('user', messageText);
            chatInput.value = '';
            isMikaTyping = true;
            appendMessage('system', 'Mika is thinking... *purrrr*');

            try {
                 chatHistory.push({ role: 'user', parts: [{ text: messageText }] });
                 if (chatHistory.length > 10) { chatHistory = chatHistory.slice(-10); }

                // Pass the key to the API function
                const mikaResponse = await sendMessageToMika(messageText, chatHistory, currentApiKey);

                 const typingIndicator = chatLog.querySelector('.system-message:last-child');
                 if (typingIndicator && typingIndicator.textContent.includes('thinking')) {
                     typingIndicator.remove();
                 }

                appendMessage('Mika', mikaResponse);
                chatHistory.push({ role: 'model', parts: [{ text: mikaResponse }] });

            } catch (error) {
                console.error("Error in handleSendMessage:", error);
                appendMessage('system', "Mrow! Something went wrong... Mika can't talk right now. ;_;");
                 const typingIndicator = chatLog.querySelector('.system-message:last-child');
                 if (typingIndicator && typingIndicator.textContent.includes('thinking')) {
                     typingIndicator.remove();
                 }
            } finally {
                isMikaTyping = false;
            }
        }

        // --- Monsterdex Logic ---
        function checkAllReplaced() { return monsterGirls.every(m => m.id === 50 || m.isReplaced); }

        function replaceEntry(monsterId) {
            const monsterIndex = monsterGirls.findIndex(m => m.id === monsterId);
             if (monsterIndex === -1 || monsterId === 50 || monsterGirls[monsterIndex].isReplaced) return false;
             replacementCounter++;
             const replacedData = { id: monsterId, name: replacementNames[replacementCounter % replacementNames.length], emoji_viz: "🚫💔", clicks: 999, isReplaced: true, review: replacementReview, alt_review_1: null, alt_review_2: null };
             monsterGirls[monsterIndex] = replacedData;
             const listItem = monsterListUl.querySelector(`li[data-id='${monsterId}']`);
             if (listItem) {
                 const newLi = listItem.cloneNode(true); // Clone to remove listeners
                 newLi.textContent = replacedData.name;
                 newLi.classList.add('replaced');
                 newLi.style.cursor = 'not-allowed';
                 listItem.parentNode.replaceChild(newLi, listItem); // Replace original with clone
             }
             if (checkAllReplaced()) { allReplaced = true; console.log("All others replaced!"); }
             return true;
        }

        // --- End Game Sequence ---

        function showFinalScreen(showChatInterface) {
            finalGlitchScreen.style.display = 'flex'; // Show the final screen container
            document.body.classList.add('glitching'); // Add class to trigger body animation

            if (showChatInterface) {
                chatInputArea.style.display = 'flex'; // Show interactive chat elements
                noApiEndingDiv.style.display = 'none'; // Hide static text

                chatHistory = []; // Start fresh conversation
                // Clear previous log content before adding new message
                chatLog.innerHTML = '';
                appendMessage('Mika', "Heehee~ You have the secret code, Master! Let's talk... forever! ♡ Ask me anything~ *Purrrrrrrrrrrr*");

                // Setup listeners only if chat is active
                sendButton.onclick = handleSendMessage; // Assign directly
                chatInput.onkeypress = (event) => {
                    if (event.key === 'Enter') { handleSendMessage(); }
                };
                 chatInput.focus();

            } else {
                chatInputArea.style.display = 'none'; // Hide interactive elements
                noApiEndingDiv.style.display = 'block'; // Show static text
                // Clear log before showing static text area
                chatLog.innerHTML = '';
                // The static text is handled by the visibility of #no-api-ending div
            }
        }

        function triggerApiPopup() {
            console.log("Showing API Key Popup!");
            apiKeyPopup.style.display = 'flex';

             // Clear previous input
             apiKeyInput.value = '';
             apiKeyError.style.display = 'none';

             // Use fresh assignments for listeners to avoid potential duplicates
             saveApiKeyButton.onclick = () => {
                 const key = apiKeyInput.value.trim();
                 if (key) {
                     sessionStorage.setItem('geminiApiKey', key);
                     console.log("API Key saved! Proceeding to chat...");
                     apiKeyPopup.style.display = 'none';
                     showFinalScreen(true); // Show chat
                 } else {
                     apiKeyError.style.display = 'block';
                 }
             };

             noThanksButton.onclick = () => {
                 console.log("No thanks chosen. Proceeding to static ending...");
                 sessionStorage.removeItem('geminiApiKey'); // Clear any potential leftover key
                 apiKeyPopup.style.display = 'none';
                 showFinalScreen(false); // Show static text ending
             };

             apiKeyInput.onkeypress = (event) => {
                 if (event.key === 'Enter') {
                     saveApiKeyButton.click();
                 }
             };
              apiKeyInput.focus(); // Focus the input field when popup appears
        }

        function triggerFinalSequence() {
            console.log("DEVOTION CONFIRMED! Starting final sequence...");
            monsterdexContainer.style.transition = 'opacity 0.5s ease-out';
            monsterdexContainer.style.opacity = '0';

            setTimeout(() => {
                monsterdexContainer.style.display = 'none';
                // Trigger the API popup AFTER fade out
                triggerApiPopup();
            }, 500); // Match fade out duration
        }


        function triggerTrueEndingOverlay() {
            console.log("TRIGGERING TRUE ENDING OVERLAY!");
             monsterListContainer.style.opacity = '0';
             initialMessageDiv.style.display = 'none';
             monsterDisplayDiv.style.opacity = '0';
             monsterDisplayDiv.style.pointerEvents = 'none';
             monsterdexContainer.style.animation = 'none';
             monsterdexContainer.style.borderColor = '#d81b60';
             monsterdexContainer.style.boxShadow = '0 0 30px rgba(216, 27, 96, 0.7)';

             setTimeout(() => {
                 monsterListContainer.innerHTML = `<div style="text-align: center; padding-top: 40%;"> <div style="font-size: 3em; color: #d81b60;">(>ω<)</div> <h2 style="color: #d81b60;">JUST ME~! ♥</h2> </div>`;
                 monsterListContainer.style.opacity = '1';
             }, 600);

             trueEndingOverlay.style.display = 'flex'; // Display the overlay
             trueEndingOverlay.classList.add('active'); // Make it interactive

             // Setup devotion button listener
             const devotionButton = document.getElementById('devotion-button');
             const newButton = devotionButton.cloneNode(true); // Clean listeners
             devotionButton.parentNode.replaceChild(newButton, devotionButton);
             newButton.addEventListener('click', triggerFinalSequence, { once: true }); // Connect to the sequence that leads to the popup
        }

        function displayMonsterInfo(monsterId) {
            console.log(`Displaying monster ID: ${monsterId}, AllReplaced: ${allReplaced}`);
             // Check if ending overlay should trigger
             if (allReplaced) {
                 // Make sure overlay isn't already shown or in process of showing
                 if (trueEndingOverlay.style.display === 'none' || !trueEndingOverlay.classList.contains('active')) {
                     console.log("All replaced, triggering true ending overlay.");
                     triggerTrueEndingOverlay();
                 }
                 return; // Stop processing this click
             }

             let monster = monsterGirls.find(m => m.id === monsterId);
             if (!monster) return;

             // Handle takeover replacement
             if (takeoverActive && monster.id !== 50 && !monster.isReplaced) {
                 if (replaceEntry(monsterId)) {
                     monster = monsterGirls.find(m => m.isReplaced && m.id === monsterId); // Get the replaced data
                     // Don't trigger ending here, let the next click handle it via the check above
                     if (allReplaced) {
                         console.log("Final replacement made. Overlay will trigger on next click.");
                     }
                 }
             }

            // Update Display Area
            initialMessageDiv.style.display = 'none';
            monsterDisplayDiv.style.display = 'flex'; // Ensure flex display
            monsterDisplayDiv.style.opacity = '1'; // Fade in

            // Increment Clicks (only if not replaced)
            if (!monster.isReplaced) {
                monster.clicks++;
                if (monster.id !== 50) {
                    distinctClicksSet.add(monster.id);
                }
            }

            // Update Content
            monsterVisualDiv.textContent = monster.emoji_viz;
            monsterNameDiv.textContent = monster.name;
            monsterReviewDiv.className = 'monster-review'; // Reset classes
            hiddenStoryArea.style.display = 'none';
            monsterNameDiv.style.backgroundColor = '#4CAF50'; // Default bg

            // Show Correct Review/Story
            if (monster.isReplaced) {
                monsterReviewDiv.innerHTML = monster.review;
                monsterReviewDiv.classList.add('replaced-entry');
                 monsterVisualDiv.textContent = "🚫💔";
                 monsterNameDiv.style.backgroundColor = '#d81b60';
            } else if (monster.id === 50) { // It's ME!
                monsterReviewDiv.innerHTML = (monster.clicks > 1 && monster.alt_review_1) ? monster.alt_review_1 : monster.review;
                let storyToShow = null;
                let distinctOthersCount = distinctClicksSet.size;
                let finalStageReached = false;
                for (let i = STORY_TRIGGER_DISTINCT_CLICKS.length - 1; i >= 0; i--) {
                    if (distinctOthersCount >= STORY_TRIGGER_DISTINCT_CLICKS[i]) {
                        storyToShow = storySnippets[i];
                        storyProgress = i + 1;
                         if (i === STORY_TRIGGER_DISTINCT_CLICKS.length - 1) finalStageReached = true;
                        break;
                    }
                }
                if (storyToShow) {
                    hiddenStoryArea.innerHTML = storyToShow;
                    hiddenStoryArea.style.display = 'block';
                     if (finalStageReached && !takeoverActive) {
                         console.log("TAKEOVER PROTOCOL ACTIVATED! Nyaa~!");
                         takeoverActive = true;
                         monsterdexContainer.style.animation = 'pulseBorder 1s infinite';
                     }
                }
            } else { // Other girls
                 if (monster.clicks >= 3 && monster.alt_review_2) {
                     monsterReviewDiv.innerHTML = monster.alt_review_2;
                     monsterReviewDiv.classList.add('alt-view-2');
                 } else if (monster.clicks >= 2 && monster.alt_review_1) {
                     monsterReviewDiv.innerHTML = monster.alt_review_1;
                     monsterReviewDiv.classList.add('alt-view-1');
                 } else {
                     monsterReviewDiv.innerHTML = monster.review;
                 }
            }

            // Update Active List Item
            const listItems = monsterListUl.querySelectorAll('li');
            listItems.forEach(item => {
                item.classList.remove('active');
                if (parseInt(item.dataset.id) === monsterId) {
                    item.classList.add('active');
                }
            });
            monsterInfoContainer.scrollTop = 0; // Scroll to top
        }

        function initializeList() {
             monsterListUl.innerHTML = ''; // Clear just in case
             monsterGirls.sort((a, b) => a.id - b.id).forEach(monster => {
                 const li = document.createElement('li');
                 li.textContent = monster.name;
                 li.dataset.id = monster.id;
                 const currentMonsterId = monster.id;
                 if (monster.isReplaced) { // Should be none initially, but good practice
                     li.classList.add('replaced');
                     li.style.cursor = 'not-allowed';
                 } else {
                     li.addEventListener('click', () => displayMonsterInfo(currentMonsterId));
                 }
                 monsterListUl.appendChild(li);
             });
        }

        // --- Initial Page Load ---
        initializeList(); // Build the list
        initialMessageDiv.style.display = 'flex'; // Show the initial message

        // Nyaa~! Everything is set up! Enjoy the journey to ME, Master~! ♡

    </script>

</body>
</html>